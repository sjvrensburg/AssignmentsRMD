$if(solutions)$
\documentclass[answers, addpoints, $if(fontsize)$$fontsize$$else$12pt$endif$]{exam}
$else$
\documentclass[addpoints, $if(fontsize)$$fontsize$$else$12pt$endif$]{exam}
$endif$

\usepackage{xifthen} % provides \isempty test
\usepackage{graphicx}

\usepackage{setspace}
\onehalfspacing

% We need simple wrappers around part, question and solution
\newenvironment{QUESTION}[1]{ % Argument is the number of marks
  \ifthenelse{\isempty{#1}} {
  % if #1 is empty
  \question
  } {
  \question[#1]
  }% if #1 is not empty
}{
}
\newenvironment{SOLUTION}[1]{ % Argument is the amount of blank space
  \begin{solution}[#1]
}{
  \end{solution}
}
\newenvironment{PARTS}{
  \begin{parts}
}{
  \end{parts}
}
\newenvironment{PART}[1]{ % Argument is the number of marks
  \part[#1]
}{
}

$if(solutions)$
% We don't want the due date, instructions, student name, etc.
\pagestyle{headandfoot}
\runningheadrule
\firstpageheader{\large \textbf{$module$}}
{\large \textbf{$title$ Model Answers}}
{\large \textbf{Total: \numpoints\ }}

\runningheader{\textbf{$module$}}
{\textbf{$title$ Model Answers}}
{\textbf{Page \thepage\ of \numpages\ }}
\firstpagefooter{}{}{}
\runningfooter{}{}{}

\begin{document}
$else$
% We require the due date, instructions, student name, etc.
\pagestyle{headandfoot}
\runningheadrule
\firstpageheader{\large \textbf{$module$}}
{\large \textbf{$title$ Due \underline{$due$}}}
{\large \textbf{Total: \numpoints\ }}

\runningheader{\textbf{$module$}}
{\textbf{$title$}}
{\textbf{Page \thepage\ of \numpages\ }}
\firstpagefooter{}{}{}
\runningfooter{}{}{}

\begin{document}

\begin{center}
\fbox{
  \fbox{
    \parbox{5.5in}{
      \centering
      Answer the questions in the spaces provided on the question sheets. If you run out of room for an answer, continue on the back of the page.
      }
    }
  }
\end{center}
\vspace{0.5cm}
\makebox[\textwidth]{Student Number:\enspace\hrulefill}
\vspace{0.5cm}
\makebox[\textwidth]{Surname, Name (Optional):\enspace\hrulefill}

$if(gradetable)$
  \vspace{\stretch{1}}
  \begin{center}
    \gradetable[v][questions]
  \end{center}
  \vspace{\stretch{2}}
  \newpage
$endif$

$endif$

\begin{questions}
  \pointsinrightmargin
  \setlength{\rightpointsmargin}{1in}
  \bracketedpoints
  \marksnotpoints
  \totalformat{\fbox{Question \thequestion: \totalpoints}}

  $body$

\end{questions}

\end{document}
